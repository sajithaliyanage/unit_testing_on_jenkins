<?xml version="1.0" encoding="utf-8" ?>

<synapse-unit-test>

    <artifacts>
        <!-- One or more xml files contains synapse configurations -->
        <test-artifact>
            <artifact>src/main/synapse-configs/sequences/seq1.xml</artifact>
        </test-artifact>
        <supportive-artifacts>
            <artifact>src/main/synapse-configs/sequences/seq2.xml</artifact>
        </supportive-artifacts>
    </artifacts>

    <test-cases>
        <test-case>
            <input>
                <payload>
                    <!-- XML or JSON -->
                </payload>
                <properties>
                    <property name="prop1" value="val1"/>
                    <property name="prop2" scope="axis2" value="val2"/>
                    <property name="prop3" scope="transport" value="val3"/>
                </properties>
            </input>

            <assertions>
                <!-- assert for payload-->
                <assertEquals>
                    <actual>$body</actual>
                    <expected>
                        {"fname":"Peter","lname":"Stallone", "age":22,"address":{"line":"20 Palm
                        Grove","city":"Colombo
                        03","country":"Sri Lanka"}}
                    </expected>
                    <message>Expected payload not found</message>
                </assertEquals>

                <assertNotNull>
                    <actual>$body</actual>
                    <message>Payload is not available</message>
                </assertNotNull>

                <!-- assert for properties-->
                <assertNotNull>
                    <actual>$ctx:prop1</actual>
                    <message>prop1 not found</message>
                </assertNotNull>

                <assertEquals>
                    <actual>$ctx:prop1</actual>
                    <expected>val1</expected>
                    <message>Expected property value not found</message>
                </assertEquals>

                <assertEquals>
                    <actual>$axis2:prop2</actual>
                    <expected>val2</expected>
                    <message>Expected property value not found</message>
                </assertEquals>

                <assertEquals>
                    <actual>$trp:prop3</actual>
                    <expected>val3</expected>
                    <message>Expected property value not found</message>
                </assertEquals>

            </assertions>
        </test-case>
    </test-cases>

    <mock-services>
        <mock-service>
            <service-name>Hospital</service-name>
            <port>9091</port>
            <context>/hello/sayHello</context>
            <resources>
                <resource>
                    <sub-context>/</sub-context>
                    <method>GET</method>
                    <request>
                        <payload>
                            {
                            "name":"John Smith",
                            "age":23,
                            "hospital":"Central Hospital"
                            }
                        </payload>
                        <headers>
                            <header name="header1" value="val1"/>
                            <header name="header2" value="val2"/>
                        </headers>
                    </request>
                    <response>
                        <payload>
                            {"fname":"Peter", "lname":"Stallone", "age":22, "address":{"line":"20 Palm Grove",
                            "city":"Colombo 03", "country":"Sri Lanka"}}
                        </payload>
                        <headers>
                            <header name="header1" value="val1"/>
                            <header name="header2" value="val2"/>
                        </headers>
                    </response>
                </resource>
            </resources>
        </mock-service>
    </mock-services>
</synapse-unit-test>
